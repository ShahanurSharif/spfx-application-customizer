<!DOCTYPE html>
<html>
<head>
    <title>SPFx Extension Test Helper</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .test-url { background: #f5f5f5; padding: 10px; border-radius: 3px; word-break: break-all; }
        code { background: #f0f0f0; padding: 2px 4px; border-radius: 2px; }
    </style>
</head>
<body>
    <h1>SPFx Extension Testing Helper</h1>
    
    <div class="test-section">
        <h2>üöÄ Step 1: Start Development Server</h2>
        <p>Make sure your development server is running:</p>
        <code>gulp serve --nobrowser</code>
        <p>You should see: <code>?debug=true&noredir=true&debugManifestsFile=https://localhost:4321/temp/build/manifests.js</code></p>
    </div>

    <div class="test-section">
        <h2>üåê Step 2: Test URL for SharePoint</h2>
        <p>Add these parameters to your SharePoint site URL:</p>
        <div class="test-url">
            ?debug=true&noredir=true&debugManifestsFile=https://localhost:4321/temp/build/manifests.js&loadSPFX=true&customActions={"5cf0b701-8c48-41ef-ad8c-cf66e6106423":{"location":"ClientSideExtension.ApplicationCustomizer"}}
        </div>
        
        <h3>Example Complete URL:</h3>
        <div class="test-url">
            https://[yourtenant].sharepoint.com/sites/[yoursite]?debug=true&noredir=true&debugManifestsFile=https://localhost:4321/temp/build/manifests.js&loadSPFX=true&customActions={"5cf0b701-8c48-41ef-ad8c-cf66e6106423":{"location":"ClientSideExtension.ApplicationCustomizer"}}
        </div>
    </div>

    <div class="test-section">
        <h2>üîç Step 3: Browser Console Debugging</h2>
        <p>Open your browser's developer console (F12) and look for these messages:</p>
        <ul>
            <li><code>Initialized Monarch360NavCrud</code> - Extension loaded</li>
            <li><code>Settings button successfully injected</code> - Button added</li>
            <li><code>Header container not found</code> - If header not detected</li>
            <li><code>Available elements: {...}</code> - Debug info about available elements</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üõ†Ô∏è Step 4: Manual Testing in SharePoint</h2>
        <p>Once on your SharePoint site, open the console and run this test:</p>
        <textarea rows="10" cols="80" readonly>
// Test if SharePoint header elements exist
console.log('=== SharePoint Header Element Test ===');
console.log('SiteHeader:', document.querySelector('[data-automationid="SiteHeader"]'));
console.log('NavigationComponent:', document.querySelector('[data-navigationcomponent="SiteHeader"]'));
console.log('SiteHeader Container:', document.querySelector('.ms-siteHeader-container'));
console.log('Suite Nav:', document.querySelector('#SuiteNavPlaceHolder'));
console.log('All potential headers:', document.querySelectorAll('[data-automationid*="Header"], [data-navigationcomponent*="Header"], .ms-siteHeader*'));

// Check if our button exists
console.log('Our Button:', document.getElementById('monarch360SettingsBtn'));
        </textarea>
    </div>

    <div class="test-section">
        <h2>‚ö†Ô∏è Troubleshooting</h2>
        <ul>
            <li><strong>Extension not loading:</strong> Ensure you're using HTTPS and the localhost server is running</li>
            <li><strong>Button not appearing:</strong> Check console for "Header container not found" messages</li>
            <li><strong>Permission errors:</strong> Make sure you have appropriate permissions on the SharePoint site</li>
            <li><strong>SSL Certificate:</strong> Accept the localhost certificate warning if prompted</li>
        </ul>
    </div>

    <script>
        // Copy URL to clipboard functionality
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('URL copied to clipboard!');
            });
        }
    </script>
</body>
</html>
